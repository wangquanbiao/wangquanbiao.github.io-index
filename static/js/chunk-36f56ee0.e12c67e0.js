(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-36f56ee0"],{6824:function(e,t,r){"use strict";r("a187")},8136:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"pcxy_comp"},[e.loading?e._e():r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[r("section",{staticClass:"section_card"},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{staticClass:"w_250",attrs:{label:"赔偿协议编号",prop:"baseData.protocolNumber"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.protocolNumber,callback:function(t){e.$set(e.ruleForm,"protocolNumber",t)},expression:"ruleForm.protocolNumber"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{staticClass:"w_250",attrs:{label:"公司名称",prop:"baseData.companyName"}},[r("el-input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.ruleForm.baseData.companyName,callback:function(t){e.$set(e.ruleForm.baseData,"companyName",t)},expression:"ruleForm.baseData.companyName"}})],1)],1),r("el-col",{attrs:{span:8}},[r("el-form-item",{staticClass:"w_250",attrs:{label:"中队名称",prop:"baseData.deptName"}},[r("el-input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.ruleForm.baseData.deptName,callback:function(t){e.$set(e.ruleForm.baseData,"deptName",t)},expression:"ruleForm.baseData.deptName"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:16}},[r("el-form-item",{staticClass:"w_1",attrs:{label:"路段及方向",prop:"baseData.accidentLocation"}},[r("el-input",{attrs:{disabled:"",placeholder:"请输入内容"},model:{value:e.ruleForm.baseData.accidentLocation,callback:function(t){e.$set(e.ruleForm.baseData,"accidentLocation",t)},expression:"ruleForm.baseData.accidentLocation"}})],1)],1)],1)],1),e._l(e.ruleForm.ywrPersonList,(function(t,s){return r("section",{key:t.lossesInfoId,staticClass:"section_card"},[r("div",{staticClass:"title table_title"},[r("span",[e._v("赔偿义务人"+e._s(s+1))])]),r("el-table",{attrs:{data:[t],border:"",stripe:""}},[r("el-table-column",{attrs:{label:"姓名",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("span",{staticClass:"star_required"},[e._v(" "+e._s(t.column.label)+" ")])]}},{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".name",rules:[{required:!0,message:"姓名不能为空",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:t.row.name,callback:function(r){e.$set(t.row,"name",r)},expression:"scope.row.name"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"车牌号码",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".carPlate"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:t.row.carPlate,callback:function(r){e.$set(t.row,"carPlate",r)},expression:"scope.row.carPlate"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"车型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".carModel"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:t.row.carModel,callback:function(r){e.$set(t.row,"carModel",r)},expression:"scope.row.carModel"}})],1)]}}],null,!0)}),e._e(),e._e(),e._e(),e._e()],1),r("div",{staticClass:"title second_title",staticStyle:{"margin-top":"25px"}},[r("div",[e._v("路产损失清单")])]),r("el-table",{attrs:{data:t.lossesInfoList,border:"",stripe:""},scopedSlots:e._u([{key:"append",fn:function(){return[r("el-row",{staticStyle:{display:"flex","background-color":"#ededed"}},[r("div",{staticStyle:{width:"77.2%",height:"100%",display:"flex","justify-content":"center","align-items":"center",padding:"15px 0","border-right":"2px solid #dfe6ec"}},[e._v(" 合计 ")]),r("div",{staticStyle:{flex:"1",height:"100%",display:"flex","justify-content":"center","align-items":"center",padding:"5px 0",margin:"10px","box-sizing":"border-box","background-color":"#f7f7f7"}},[e._v(" "+e._s(t.totalAmount||"自动计算")+" ")])])]},proxy:!0}],null,!0)},[r("el-table-column",{attrs:{label:"路产名称",align:"center"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("span",{staticClass:"star_required"},[e._v(" "+e._s(t.column.label)+" ")])]}},{key:"default",fn:function(t){return[r("el-form-item",{staticClass:"w_1",attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".name",rules:[{required:!0,message:"路产名称不能为空",trigger:"change"}]}},[r("el-select",{staticClass:"mingcheng",attrs:{clearable:"",placeholder:"请选择"},on:{change:function(r){return e.lossesNameChange(r,s,t.$index)}},model:{value:t.row.name,callback:function(r){e.$set(t.row,"name",r)},expression:"scope.row.name"}},e._l(e.keywordList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.name}})})),1)],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"单价",align:"center",width:"120"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("span",{staticClass:"star_required"},[e._v(" "+e._s(t.column.label)+" ")])]}},{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".unitPrice",rules:[{required:!0,message:"单价不能为空",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"请输入"},on:{change:function(r){return e.changMoney(r,s,t.$index)}},model:{value:t.row.unitPrice,callback:function(r){e.$set(t.row,"unitPrice",r)},expression:"scope.row.unitPrice"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"数量",align:"center",width:"120"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("span",{staticClass:"star_required"},[e._v(" "+e._s(t.column.label)+" ")])]}},{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".count",rules:[{required:!0,message:"单价不能为空",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"请输入"},on:{change:function(r){return e.changMoney(r,s,t.$index)}},model:{value:t.row.count,callback:function(r){e.$set(t.row,"count",r)},expression:"scope.row.count"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"单位",align:"center",width:"120"},scopedSlots:e._u([{key:"header",fn:function(t){return[r("span",{staticClass:"star_required"},[e._v(" "+e._s(t.column.label)+" ")])]}},{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".unit",rules:[{required:!0,message:"单位不能为空",trigger:"blur"}]}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:t.row.unit,callback:function(r){e.$set(t.row,"unit",r)},expression:"scope.row.unit"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"金额小计",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".subtotal"}},[r("el-input",{attrs:{disabled:"",placeholder:"自动计算"},model:{value:t.row.subtotal,callback:function(r){e.$set(t.row,"subtotal",r)},expression:"scope.row.subtotal"}})],1)]}}],null,!0)}),r("el-table-column",{attrs:{label:"备注",align:"center",width:"170"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{"label-width":"0px",prop:"ywrPersonList."+s+".lossesInfoList."+t.$index+".remark"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:t.row.remark,callback:function(r){e.$set(t.row,"remark",r)},expression:"scope.row.remark"}})],1)]}}],null,!0)})],1),r("el-row",{staticStyle:{"margin-top":"15px"}},[r("el-col",{attrs:{span:24}},[r("el-form-item",{staticClass:"w_1",staticStyle:{width:"100%"},attrs:{label:"事件认定",prop:"ywrPersonList."+s+".eventDesc"}},[r("el-input",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.eventDesc,callback:function(r){e.$set(t,"eventDesc",r)},expression:"t.eventDesc"}})],1)],1)],1)],1)})),r("section",{staticClass:"section_card",staticStyle:{"margin-top":"15px"}},[r("el-row",[r("el-col",{attrs:{span:24}},[r("el-form-item",{staticClass:"w_250",attrs:{"label-width":"170",label:"路产赔偿办理单位经办人",prop:"unitOperator"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.unitOperator,callback:function(t){e.$set(e.ruleForm,"unitOperator",t)},expression:"ruleForm.unitOperator"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{staticClass:"w_250",attrs:{"label-width":"170",label:"路产赔偿办理单位负责人",prop:"unitLeader"}},[r("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.ruleForm.unitLeader,callback:function(t){e.$set(e.ruleForm,"unitLeader",t)},expression:"ruleForm.unitLeader"}})],1)],1)],1)],1),r("section",{staticStyle:{display:"flex","justify-content":"center",padding:"25px 0"}},[r("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],2)],1)},o=[],n=r("5530"),a=r("c7eb"),l=r("1da1"),i=(r("4de4"),r("7db0"),r("a15b"),r("d81d"),r("14d9"),r("b0c0"),r("e9c4"),r("a9e3"),r("b64b"),r("d3b7"),r("e95a7")),u=r("2934"),c=r("fa7d"),d=r("06d0"),m={props:{deptId:{type:[String,Number]},close:{type:Function,require:!0},show:{type:Boolean}},watch:{show:{handler:function(e,t){e?!this.loading&&this.getData():this.ruleForm={}},deep:!0}},data:function(){return{loading:!0,isChange:"1",ruleForm:{ywrPersonList:[],cbrPerson:void 0,baseData:{protocolNumber:void 0}},rules:{address:[{required:!0,message:"请填写",trigger:"blur"}],category:[{required:!0,message:"请选择",trigger:"change"}],source:[{required:!0,message:"请选择",trigger:"change"}],fsTime:[{required:!0,message:"请选择",trigger:"change"}],ddTime:[{required:!0,message:"请选择",trigger:"change"}],cbrPerson:[{required:!0,message:"请选择",trigger:"change"}],kcStartTime:[{required:!0,message:"请选择",trigger:"change"}],kcEndTime:[{required:!0,message:"请选择",trigger:"change"}]},categoryList:[{label:"损坏公共路产",value:"损坏公共路产"}],userInfoList:[],keywordList:[]}},mounted:function(){var e=this;this.$nextTick((function(){e.getData()}))},methods:{lossesNameChange:function(e,t,r){var s=this.keywordList.find((function(t){return t.name==e}));s&&(this.ruleForm.ywrPersonList[t].lossesInfoList[r].unitPrice=s.unitPrice,this.ruleForm.ywrPersonList[t].lossesInfoList[r].count=1,this.ruleForm.ywrPersonList[t].lossesInfoList[r].unit=s.unit,this.ruleForm.ywrPersonList[t].lossesInfoList[r].subtotal=s.subtotal,this.changMoney(e,t,r))},changMoney:function(e,t,r){var s=this.ruleForm.ywrPersonList[t].lossesInfoList[r];s.subtotal=Number(s.count)*Number(s.unitPrice);var o=0;this.ruleForm.ywrPersonList[t].lossesInfoList.map((function(e){o+=Number(e.subtotal||0)})),this.$set(this.ruleForm.ywrPersonList[t],"totalAmount",o)},lossesInfoListAdd:function(e){var t={name:void 0,unitPrice:void 0,count:void 0,unit:void 0,subtotal:void 0,remark:void 0,lossesInfoId:Date.now()*(100*Math.random())};this.ruleForm.ywrPersonList[e].lossesInfoList.push(t)},lossesInfoListDel:function(e,t){var r=this;this.ruleForm.ywrPersonList[e].lossesInfoList=this.ruleForm.ywrPersonList[e].lossesInfoList.filter((function(e){return e.lossesInfoId!=t})),this.ruleForm.ywrPersonList[e].totalAmount=0,this.ruleForm.ywrPersonList[e].lossesInfoList.map((function(t){r.ruleForm.ywrPersonList[e].totalAmount+=Number(t.subtotal||0)}))},remotekeywordItemList:function(e){Object(c["c"])(this.getkeywordItemList(e),500)},getkeywordItemList:function(e){var t=this;return Object(l["a"])(Object(a["a"])().mark((function r(){var s;return Object(a["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(d["g"])(e);case 2:s=r.sent,t.keywordList=s.data;case 4:case"end":return r.stop()}}),r)})))()},ywrPersonListAdd:function(){this.ruleForm.ywrPersonList=this.ruleForm.ywrPersonList||[];var e=Date.now(),t={name:"",gender:"",age:"",deptName:"",occupation:"",lossesInfoId:String(e),lossesInfoList:[{name:"",unitPrice:"",count:"",unit:"",subtotal:"",remark:"",lossesInfoId:String(e)}]};this.ruleForm.ywrPersonList.push(t)},ywrPersonListDel:function(e){this.ruleForm.ywrPersonList=this.ruleForm.ywrPersonList.filter((function(t){return t.lossesInfoId!=e}))},submitForm:function(e){var t=this;this.$refs[e].validate(function(){var e=Object(l["a"])(Object(a["a"])().mark((function e(r){var s,o;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r&&(s=JSON.parse(JSON.stringify(t.ruleForm)),o=JSON.parse(JSON.stringify(s.baseData)),o.dsrList=s.ywrPersonList,s.ywrPersonList.map((function(e,t){s.inners[t]={dsr:{}},s.inners[t].dsr=e})),delete s.cbrPerson,delete s.ywrPersonList,delete s.baseData,Object(i["b"])({pcxy:s,baseData:o},{businessId:t.$route.query.id,docCode:"new_pcxy"}).then((function(e){200==e.code&&(t.loading=!1,t.$message.success("保存成功"),t.$emit("close"))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},userList:function(){var e=this;return Object(l["a"])(Object(a["a"])().mark((function t(){var r;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(u["q"])({deptId:e.deptId});case 2:r=t.sent,e.userInfoList=r.rows;case 4:case"end":return t.stop()}}),t)})))()},getData:function(){var e=this;return Object(l["a"])(Object(a["a"])().mark((function t(){return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(i["a"])({businessId:e.$route.query.id,docCode:"new_pcxy"}).then((function(t){var r;if(t.data.cbrPerson=[],e.ruleForm=t.data.pcxy||e.ruleForm,e.ruleForm.baseData=Object(n["a"])({},t.data.baseData),e.ruleForm.ywrPersonList=[],e.ruleForm.inners&&e.ruleForm.inners.length>0&&e.ruleForm.inners.map((function(t){e.ruleForm.ywrPersonList.push(Object(n["a"])(Object(n["a"])({},t.dsr),{},{eventDesc:t.dsr.eventDesc?t.dsr.eventDesc:t.ssrd}))})),e.ruleForm.baseData&&e.ruleForm.baseData.lossesInfoList&&(e.keywordList=e.ruleForm.baseData.lossesInfoList),!e.ruleForm.ywrPersonList||0==e.ruleForm.ywrPersonList.length){var s,o=Math.floor(Date.now()*(100*Math.random())),a={name:"",gender:"",age:"",deptName:"",occupation:"",lossesInfoId:String(o),lossesInfoList:[{name:"",unitPrice:"",count:"",unit:"",subtotal:"",remark:"",lossesInfoId:String(o)}]};e.ruleForm.ywrPersonList=[a],null===(s=e.ruleForm.baseData)||void 0===s||null===(s=s.dsrList)||void 0===s||s.map((function(t,r){var s;t.lossesInfoId=String(o),null===(s=t.lossesInfoList)||void 0===s||s.map((function(e){e.lossesInfoId=Math.floor(Date.now()*(100*Math.random()))})),e.ruleForm.ywrPersonList[r]=t}))}e.ruleForm.ywrPersonList.map((function(e,t){e.lossesInfoId=(e.name||"")+Date.now()+t,e.lossesInfoList&&e.lossesInfoList.length>0&&e.lossesInfoList.map((function(t,r){t.lossesInfoId=e.lossesInfoId+(t.name||"")+r}))})),e.ruleForm.unitOperator=e.ruleForm.unitOperator||(null===(r=e.ruleForm.baseData)||void 0===r||null===(r=r.clrList)||void 0===r?void 0:r.map((function(e){return e.name})).join(",")),e.loading=!1}));case 3:case"end":return t.stop()}}),t)})))()}}},p=m,f=(r("6824"),r("2877")),b=Object(f["a"])(p,s,o,!1,null,"69d8f82e",null);t["default"]=b.exports},a187:function(e,t,r){},e95a7:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return n}));r("99af");var s=r("b775");function o(e){var t=e.businessId,r=e.docCode;return Object(s["a"])({url:"/roadProducts/roadDoc/docDetails/".concat(t,"/").concat(r),method:"get"})}function n(e,t){var r=t.businessId,o=t.docCode;return Object(s["a"])({url:"/roadProducts/roadDoc/saveDoc/".concat(r,"/").concat(o),method:"post",data:e})}}}]);