(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0fbe020"],{1728:function(e,t,r){"use strict";r("aba3")},aba3:function(e,t,r){},d88d:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("el-dialog",{attrs:{title:"其他",visible:e.isShow,isShow:e.show,"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isShow=t},close:function(t){e.$emit("update:show",!1)}}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px",disabled:!e.isBtn}},[r("div",{staticClass:"card"},[r("div",{staticClass:"title"},[e._v("基础信息")]),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"设施名称：",prop:"facilityName"}},[r("el-input",{attrs:{placeholder:"输入名称"},model:{value:e.ruleForm.facilityName,callback:function(t){e.$set(e.ruleForm,"facilityName",t)},expression:"ruleForm.facilityName"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"路线名称：",prop:"roadId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.setInitPage},model:{value:e.ruleForm.roadId,callback:function(t){e.$set(e.ruleForm,"roadId",t)},expression:"ruleForm.roadId"}},e._l(e.roadList,(function(e,t){return r("el-option",{key:t,attrs:{label:e.roadDesc,value:e.id}})})),1)],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"路线编码："}},[r("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.roadCode,callback:function(t){e.$set(e.ruleForm,"roadCode",t)},expression:"ruleForm.roadCode"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"单位名称：",prop:"companyId"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.setZDID},model:{value:e.ruleForm.companyId,callback:function(t){e.$set(e.ruleForm,"companyId",t)},expression:"ruleForm.companyId"}},e._l(e.depList,(function(e){return r("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}})})),1)],1)],1)],1)],1),r("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},["123"==e.ruleForm.relationId?r("div",{staticClass:"card"},[r("div",{staticClass:"title"},[e._v("监控中心信息")]),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"监控中心名称：",prop:"monitorCenter"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.monitorCenter,callback:function(t){e.$set(e.ruleForm,"monitorCenter",t)},expression:"ruleForm.monitorCenter"}})],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{"label-width":"150px",label:"监控系统管理体制：",prop:"monitorSystemDesc"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.monitorSystemDesc,callback:function(t){e.$set(e.ruleForm,"monitorSystemDesc",t)},expression:"ruleForm.monitorSystemDesc"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"监控级别：",prop:"monitorLevel"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.monitorLevel,callback:function(t){e.$set(e.ruleForm,"monitorLevel",t)},expression:"ruleForm.monitorLevel"}})],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"监控设备：",prop:"monitorEquipment"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.monitorEquipment,callback:function(t){e.$set(e.ruleForm,"monitorEquipment",t)},expression:"ruleForm.monitorEquipment"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"负责人：",prop:"userName"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.userName,callback:function(t){e.$set(e.ruleForm,"userName",t)},expression:"ruleForm.userName"}})],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"建设时间：",prop:"buildTime"}},[r("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm",placeholder:"选择日期时间"},model:{value:e.ruleForm.buildTime,callback:function(t){e.$set(e.ruleForm,"buildTime",t)},expression:"ruleForm.buildTime"}})],1)],1)],1)],1):r("div",{staticClass:"card"},[r("div",{staticClass:"title"},[e._v("设施信息")]),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"路产内容：",prop:"roadProductContent "}},[r("el-input",{attrs:{placeholder:"输入路产内容"},model:{value:e.ruleForm.roadProductContent,callback:function(t){e.$set(e.ruleForm,"roadProductContent",t)},expression:"ruleForm.roadProductContent"}})],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"建立时间：",prop:"buildTime"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择日期","value-format":"yyyy-MM-dd hh:mm"},model:{value:e.ruleForm.buildTime,callback:function(t){e.$set(e.ruleForm,"buildTime",t)},expression:"ruleForm.buildTime"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"起点桩号：",prop:"startLineKmLevel"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.startLineKmLevel,callback:function(t){e.$set(e.ruleForm,"startLineKmLevel",t)},expression:"ruleForm.startLineKmLevel"}},[r("template",{slot:"prepend"},[e._v("k")])],2)],1),r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.startLineMLevel,callback:function(t){e.$set(e.ruleForm,"startLineMLevel",t)},expression:"ruleForm.startLineMLevel"}},[r("template",{slot:"prepend"},[e._v("+")])],2)],1)],1)],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"终点桩号：",prop:"endLineKmLevel"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.endLineKmLevel,callback:function(t){e.$set(e.ruleForm,"endLineKmLevel",t)},expression:"ruleForm.endLineKmLevel"}},[r("template",{slot:"prepend"},[e._v("k")])],2)],1),r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.endLineMLevel,callback:function(t){e.$set(e.ruleForm,"endLineMLevel",t)},expression:"ruleForm.endLineMLevel"}},[r("template",{slot:"prepend"},[e._v("+")])],2)],1)],1)],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"中心桩号：",prop:"lineKmLevel"}},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.lineKmLevel,callback:function(t){e.$set(e.ruleForm,"lineKmLevel",t)},expression:"ruleForm.lineKmLevel"}},[r("template",{slot:"prepend"},[e._v("k")])],2)],1),r("el-col",{attrs:{span:12}},[r("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.lineMLevel,callback:function(t){e.$set(e.ruleForm,"lineMLevel",t)},expression:"ruleForm.lineMLevel"}},[r("template",{slot:"prepend"},[e._v("+")])],2)],1)],1)],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"所在辖区：",prop:"roadProductLocation"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.roadProductLocation,callback:function(t){e.$set(e.ruleForm,"roadProductLocation",t)},expression:"ruleForm.roadProductLocation"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"路产数量：",prop:"roadProductQuantity"}},[r("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.roadProductQuantity,callback:function(t){e.$set(e.ruleForm,"roadProductQuantity",t)},expression:"ruleForm.roadProductQuantity"}})],1)],1),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"设施状况：",prop:"status"}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.status,callback:function(t){e.$set(e.ruleForm,"status",t)},expression:"ruleForm.status"}},e._l(e.status,(function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),r("div",{staticClass:"card"},[r("div",{staticClass:"title"},[e._v("设施照片")]),r("el-row",[r("el-form-item",{attrs:{label:"设施照片：",prop:"pic"}},[r("upload",{attrs:{filesList:e.filesList},on:{returnRes:e._returnRes,returnResDel:e._returnResDel},model:{value:e.ruleForm.pic,callback:function(t){e.$set(e.ruleForm,"pic",t)},expression:"ruleForm.pic"}})],1)],1),"123"!=e.ruleForm.relationId?r("el-row",[r("el-form-item",{attrs:{label:"拍摄时间：",prop:"picTime"}},[r("el-date-picker",{attrs:{type:"date",placeholder:"请选择日期","value-format":"yyyy-MM-dd"},model:{value:e.ruleForm.picTime,callback:function(t){e.$set(e.ruleForm,"picTime",t)},expression:"ruleForm.picTime"}})],1)],1):e._e(),r("el-row",[r("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.remark,callback:function(t){e.$set(e.ruleForm,"remark",t)},expression:"ruleForm.remark"}})],1)],1)],1)]),e.isBtn?r("el-form-item",{staticStyle:{"margin-top":"40px"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),r("el-button",{on:{click:function(t){return e.resetForm("ruleForm")}}},[e._v("重置")])],1):e._e()],1)],1)],1)},l=[],o=r("5530"),s=r("c7eb"),i=r("1da1"),n=(r("4de4"),r("a15b"),r("d81d"),r("14d9"),r("b0c0"),r("d3b7"),r("2934")),c=r("a700"),u=r("36fa"),m={components:{upload:u["a"]},props:{show:{type:Boolean,default:!1},search:{type:Object,default:function(){return{}}}},watch:{show:function(){this.isShow=this.show},search:{handler:function(e,t){this.ruleForm.relationId=e.relationId},immediate:!0}},data:function(){return{isShowInformation:!0,cascaderKey:0,isBtn:!0,isShowLoading:!1,isShow:this.show,reqUrl:"add",stateList:[],depList:[],DWList:[],roadList:[],activeNames:["1","2"],status:[{label:"在用",value:1},{label:"废弃",value:0},{label:"停用",value:2}],ruleForm:{relationId:"",orgId:"",orgDesc:"",companyId:"",companyDesc:"",roadId:"",roadCode:"",roadDesc:"",technicalLevel:"",rampDir:"",rampName:"",pic:"",picTime:"",buildTime:"",monitorCenter:"",monitorSystemDesc:"",userName:"",monitorLevel:"",monitorEquipment:"",remark:"",facilityName:"",roadProductContent:"",startLineKmLevel:"",startLineMLevel:"",endLineKmLevel:"",endLineMLevel:"",lineKmLevel:"",lineMLevel:"",roadProductLocation:"",roadProductQuantity:""},filesList:[],imgsList:[],rules:{roadId:[{required:!0,message:"请选择",trigger:"change"}],pic:[{required:!0,message:"请选择",trigger:"change"}],buildTime:[{required:!0,message:"请选择",trigger:"change"}],companyId:[{required:!0,message:"请选择",trigger:"change"}],orgId:[{required:!0,message:"请选择",trigger:"change"}],technicalLevel:[{required:!0,message:"请选择",trigger:"change"}],roadCode:[{required:!0,message:"请选择",trigger:"change"}],roadDesc:[{required:!0,message:"请选择",trigger:"change"}],monitorCenter:[{required:!0,message:"请选择",trigger:"blur"}],monitorSystemDesc:[{required:!0,message:"请选择",trigger:"blur"}],monitorLevel:[{required:!0,message:"请选择",trigger:"blur"}],monitorEquipment:[{required:!0,message:"请选择",trigger:"blur"}],userName:[{required:!0,message:"请选择",trigger:"blur"}]}}},created:function(){this.INITDATA(),this.getData(),this.getstateList()},methods:{handleChange:function(e){var t;this.$refs.otherCascader&&(this.ruleForm.orgDesc=null===(t=this.$refs.otherCascader.getCheckedNodes()[0])||void 0===t?void 0:t.data.label,this.$refs.otherCascader.dropDownVisible=!1)},setRelationId:function(e){this.ruleForm.relationId=e},_returnRes:function(e){var t={name:e.fileName,attachId:e.id,fileUrl:e.fileUrl};this.imgsList.push(t)},_returnResDel:function(e){this.imgsList=this.imgsList.filter((function(t){return t.attachId!=e.id}))},getstateList:function(){return Object(i["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},setInitPage:function(e){for(var t=0;t<this.roadList.length;t++)if(this.roadList[t].id==e){this.ruleForm.roadCode=this.roadList[t].roadCode,this.ruleForm.technicalLevel=this.roadList[t].technicalLevel;break}},getData:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var r,a,l,i,u,m,d,p;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.$store.getters.userInfo,a="",l="",r.admin||(r.gly?a=r.companyId:l=r.orgId),i={companyId:a,orgId:l},u=Object(o["a"])(Object(o["a"])({},i),{},{pageNum:1,pageSize:99}),t.next=7,Object(c["J"])(u);case 7:return m=t.sent,e.roadList=m.rows,t.next=11,Object(n["j"])();case 11:return d=t.sent,e.depList=d.data,t.next=15,Object(n["g"])({ancestors:e.$store.getters.userInfo.companyId,isFilter:!0});case 15:if(p=t.sent,e.cascaderKey++,e.DWList=p.data,e.$store.getters.userInfo.roles.map((function(t){("jtld"==t.roleKey||t.admin)&&(e.isShowInformation=!1)})),e.isShowInformation){t.next=21;break}return t.abrupt("return");case 21:e.ruleForm.companyDesc=e.$store.getters.userInfo.companyName,e.ruleForm.companyId=e.$store.getters.userInfo.companyId,e.ruleForm.orgId=e.$store.getters.userInfo.dept.deptId,e.ruleForm.orgDesc=e.$store.getters.userInfo.dept.deptName;case 25:case"end":return t.stop()}}),t)})))()},submitForm:function(e){var t=this,r="add"==this.reqUrl?"post":"put";0!=this.imgsList.length&&(this.ruleForm.pic=this.imgsList.map((function(e){return e.attachId})).join(",")),this.$refs[e].validate((function(e){if(!e)return!1;for(var a=0;a<t.roadList.length;a++)if(t.ruleForm.roadCode==t.roadList[a].roadCode){t.ruleForm.roadDesc=t.roadList[a].roadDesc;break}t.isShowLoading||(t.isShowLoading=!0,Object(c["A"])(t.ruleForm,t.reqUrl,r).then((function(e){200==e.code&&(t.$message({message:"成功!",type:"success"}),t.$emit("notice"),t.isShowLoading=!1,t.resetForm("ruleForm"),t.isShow=!1)})).catch((function(e){t.isShowLoading=!1})))}))},resetForm:function(e){this.ruleForm.orgId=void 0,this.ruleForm.companyId=void 0,this.ruleForm.technicalLevel=void 0,this.imgsList=[],this.filesList=[],this.$refs[e].resetFields(),this.isShowInformation&&(this.ruleForm.companyDesc=this.$store.getters.userInfo.companyName,this.ruleForm.companyId=this.$store.getters.userInfo.companyId,this.ruleForm.orgId=this.$store.getters.userInfo.dept.deptId,this.ruleForm.orgDesc=this.$store.getters.userInfo.dept.deptName)},setIsShowBtn:function(e){this.isBtn=e},setUrl:function(e){this.reqUrl=e},getInfo:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function r(){var a,l;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.isShow=!0,r.next=3,Object(c["C"])(e);case 3:a=r.sent,t.setZDID(a.data.companyId),t.ruleForm=a.data,l=a.data,l.picList&&(t.filesList=l.picList.map((function(e){var r={response:{data:{}}},a={};return r.name=e.fileName,r.fileName=e.fileName,r.id=e.id,r.fileUrl=e.fileUrl,r.url="/prod-api"+e.fileUrl,r.response.data.name=e.fileName,r.response.data.fileName=e.fileName,r.response.data.id=e.id,r.response.data.fileUrl=e.fileUrl,r.response.data.url="/prod-api"+e.fileUrl,a.name=e.fileName,a.attachId=e.id,a.fileUrl=e.fileUrl,t.imgsList.push(a),r})));case 8:case"end":return r.stop()}}),r)})))()},setZDID:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function r(){var a,l,o;return Object(s["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.DWList=[],t.ruleForm.orgId=void 0,t.ruleForm.orgDesc=void 0,t.ruleForm.companyDesc=t.depList.filter((function(t){return t.deptId==e}))[0].deptName,t.cascaderKey=0,r.next=7,Object(n["g"])({ancestors:e,isFilter:!0});case 7:return a=r.sent,t.DWList=a.data,l={pageNum:1,pageSize:99,companyId:e},r.next=12,Object(c["J"])(l);case 12:o=r.sent,t.roadList=o.rows;case 14:case"end":return r.stop()}}),r)})))()},INITDATA:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var r;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(n["k"])({dictType:"road_main_line_level"});case 2:r=t.sent,e.stateList=r.rows;case 4:case"end":return t.stop()}}),t)})))()}}},d=m,p=(r("1728"),r("2877")),f=Object(p["a"])(d,a,l,!1,null,"881de776",null);t["default"]=f.exports}}]);