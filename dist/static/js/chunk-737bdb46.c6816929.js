(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-737bdb46"],{"013f":function(t,e,n){"use strict";n("5850")},"1b0f":function(t,e,n){"use strict";n("220f")},"220f":function(t,e,n){},2627:function(t,e,n){},"29f9":function(t,e,n){"use strict";n("5e63")},"340d":function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"d",(function(){return r})),n.d(e,"g",(function(){return s})),n.d(e,"m",(function(){return c})),n.d(e,"j",(function(){return h})),n.d(e,"f",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return m})),n.d(e,"k",(function(){return p})),n.d(e,"l",(function(){return f})),n.d(e,"a",(function(){return y}));var i=n("b775");function o(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/getClaimTotalInfo",method:"post",data:t})}function a(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/compensationStatistics",method:"post",data:t})}function r(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/compensationEventHandlingRanking/".concat(t.type),method:"post",data:t})}function s(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/reportClaimList",method:"post",data:t})}function c(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/remove",method:"DELETE",data:t})}function h(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/claimQueryList",method:"post",data:t})}function l(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/detail/".concat(t),method:"get"})}function u(t){return Object(i["a"])({url:"/onlyOffice/edit/".concat(t),method:"get"})}function d(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/query",method:"post",data:t})}function m(t){return Object(i["a"])({url:"/roadProducts/tReportClaimInfo/queryTotal",method:"post",data:t})}function p(t){return Object(i["a"])({url:"/statistics/lp/monthTotalStat",method:"post",data:t})}function f(t){return Object(i["a"])({url:"/statistics/lp/listCompany",method:"post",data:t})}function y(t){return Object(i["a"])({url:"/statistics/lp/submit",method:"put",data:t})}},3887:function(t,e,n){"use strict";n("ae36")},"3d02":function(t,e,n){"use strict";n("2627")},4159:function(t,e,n){},5850:function(t,e,n){},"5e63":function(t,e,n){},"6d0f":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("main",[n("section",{staticClass:"left"},[n("ComponentList")],1),n("section",{staticClass:"center"},[n("div",{staticStyle:{"margin-bottom":"16px","margin-left":"14px"}},[n("el-button",{attrs:{type:"primary"},on:{click:t.handleSaveCanvas}},[t._v("完成绘制并上传")])],1),n("div",{staticClass:"content",attrs:{id:"content"},on:{drop:t.handleDrop,dragover:t.handleDragOver,mousedown:t.handleMouseDown,mouseup:t.deselectCurComponent}},[n("EditorX")],1)])])])},o=[],a=n("c7eb"),r=n("1da1"),s=(n("e9c4"),n("ac1f"),n("5319"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"editor",class:{edit:t.isEdit},style:Object.assign({},t.getCanvasStyle(t.canvasStyleData),{width:t.changeStyleWithScale(t.canvasStyleData.width)+"px",height:t.changeStyleWithScale(t.canvasStyleData.height)+"px"}),attrs:{id:"editor"},on:{contextmenu:t.handleContextMenu,mousedown:t.handleMouseDown}},[n("Grid"),t._l(t.componentData,(function(e,i){return n("Shape",{key:e.id,class:{lock:e.isLock},style:t.getShapeStyle(e.style),attrs:{"default-style":e.style,active:e.id===(t.curComponent||{}).id,element:e,index:i}},[e.component.startsWith("SVG")?n(e.component,{tag:"component",staticClass:"component",style:t.getSVGStyle(e.style),attrs:{id:"component"+e.id,"prop-value":e.propValue,element:e,request:e.request}}):"VText"!=e.component?n(e.component,{tag:"component",staticClass:"component",style:t.getComponentStyle(e.style),attrs:{id:"component"+e.id,"prop-value":e.propValue,element:e,request:e.request}}):n(e.component,{tag:"component",staticClass:"component",style:t.getComponentStyle(e.style),attrs:{id:"component"+e.id,"prop-value":e.propValue,element:e,request:e.request},on:{input:t.handleInput}})],1)})),n("ContextMenu"),n("MarkLine"),n("Area",{directives:[{name:"show",rawName:"v-show",value:t.isShowArea,expression:"isShowArea"}],attrs:{start:t.start,width:t.width,height:t.height}}),t.isShowLine?n("div",[n("div",{staticClass:"line line1"}),n("div",{staticClass:"line line2"}),n("div",{staticClass:"line line3"}),n("div",{staticClass:"line line4"}),n("div",{staticClass:"number number1"},[t._v("1")]),n("div",{staticClass:"number number2"},[t._v("2")]),n("div",{staticClass:"number number3"},[t._v("3")]),n("div",{staticClass:"number number4"},[t._v("4")])]):t._e()],2)}),c=[],h=(n("caad"),n("14d9"),n("d3b7"),n("2532"),n("159b"),n("2f62")),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shape",class:{active:t.active},on:{click:t.selectCurComponent,mousedown:t.handleMouseDownOnShape}},[n("span",{directives:[{name:"show",rawName:"v-show",value:t.isActive(),expression:"isActive()"}],staticClass:"iconfont icon-shuaxin",on:{mousedown:t.handleRotate}}),n("span",{directives:[{name:"show",rawName:"v-show",value:t.element.isLock,expression:"element.isLock"}],staticClass:"iconfont icon-suo"}),t._l(t.isActive()?t.getPointList():[],(function(e){return n("div",{key:e,staticClass:"shape-point",style:t.getPointStyle(e),on:{mousedown:function(n){return t.handleMouseDownOnPoint(e,n)}}})})),t._t("default")],2)},u=[],d=n("b85c"),m=n("5530"),p=(n("a9e3"),n("00b4"),n("986e"));function f(t){return y.apply(this,arguments)}function y(){return y=Object(r["a"])(Object(a["a"])().mark((function t(e){var n,i,o,r,s=arguments;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=s.length>1&&void 0!==s[1]?s[1]:[],i=function(t){return new Promise((function(n){var i=t.animationTime,o=t.value,a=void 0===o?"":o,r=t.isLoop;e.style.setProperty("--time",i+"s"),e.classList.add(a,"animated",v(r));var s=function t(){e.removeEventListener("animationend",t),e.removeEventListener("animationcancel",t),e.classList.remove(a,"animated",v(r)),e.style.removeProperty("--time"),n()};e.addEventListener("animationend",s),e.addEventListener("animationcancel",s)}))},o=0,r=n.length;case 3:if(!(o<r)){t.next=9;break}return t.next=6,i(n[o]);case 6:o++,t.next=3;break;case 9:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}function v(t){return t?"infinite":"no-infinite"}var g=n("a2ba"),b={lt:x,t:O,rt:w,r:j,rb:S,b:M,lb:C,l:$};function x(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=Object(g["d"])(e,r),c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])(r,s,-t.rotate),l=h.x-c.x,u=h.y-c.y;if(i){l/u>n?(c.x+=Math.abs(l-u*n),l=u*n):(c.y+=Math.abs(u-l/n),u=l/n);var d=Object(g["a"])(c,s,t.rotate);s=Object(g["d"])(d,r),c=Object(g["a"])(d,s,-t.rotate),h=Object(g["a"])(r,s,-t.rotate),l=h.x-c.x,u=h.y-c.y}l>0&&u>0&&(t.width=Math.round(l),t.height=Math.round(u),t.left=Math.round(c.x),t.top=Math.round(c.y),t.fontSize=a)}function w(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=Object(g["d"])(e,r),c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])(r,s,-t.rotate),l=c.x-h.x,u=h.y-c.y;if(i){l/u>n?(c.x-=Math.abs(l-u*n),l=u*n):(c.y+=Math.abs(u-l/n),u=l/n);var d=Object(g["a"])(c,s,t.rotate);s=Object(g["d"])(d,r),c=Object(g["a"])(d,s,-t.rotate),h=Object(g["a"])(r,s,-t.rotate),l=c.x-h.x,u=h.y-c.y}l>0&&u>0&&(t.width=Math.round(l),t.height=Math.round(u),t.left=Math.round(h.x),t.top=Math.round(c.y),t.fontSize=a)}function S(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=Object(g["d"])(e,r),c=Object(g["a"])(r,s,-t.rotate),h=Object(g["a"])(e,s,-t.rotate),l=h.x-c.x,u=h.y-c.y;if(i){l/u>n?(h.x-=Math.abs(l-u*n),l=u*n):(h.y-=Math.abs(u-l/n),u=l/n);var d=Object(g["a"])(h,s,t.rotate);s=Object(g["d"])(d,r),c=Object(g["a"])(r,s,-t.rotate),h=Object(g["a"])(d,s,-t.rotate),l=h.x-c.x,u=h.y-c.y}l>0&&u>0&&(t.width=Math.round(l),t.height=Math.round(u),t.left=Math.round(c.x),t.top=Math.round(c.y),t.fontSize=a)}function C(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=Object(g["d"])(e,r),c=Object(g["a"])(r,s,-t.rotate),h=Object(g["a"])(e,s,-t.rotate),l=c.x-h.x,u=h.y-c.y;if(i){l/u>n?(h.x+=Math.abs(l-u*n),l=u*n):(h.y-=Math.abs(u-l/n),u=l/n);var d=Object(g["a"])(h,s,t.rotate);s=Object(g["d"])(d,r),c=Object(g["a"])(r,s,-t.rotate),h=Object(g["a"])(d,s,-t.rotate),l=c.x-h.x,u=h.y-c.y}l>0&&u>0&&(t.width=Math.round(l),t.height=Math.round(u),t.left=Math.round(h.x),t.top=Math.round(c.y),t.fontSize=a)}function O(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=o.curPoint,c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])({x:s.x,y:c.y},s,t.rotate),l=Math.sqrt(Math.pow(h.x-r.x,2)+Math.pow(h.y-r.y,2)),u={x:h.x-(h.x-r.x)/2,y:h.y+(r.y-h.y)/2},d=t.width;i&&(d=l*n),t.width=d,t.height=Math.round(l),t.top=Math.round(u.y-l/2),t.left=Math.round(u.x-t.width/2),t.fontSize=a}function j(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=o.curPoint,c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])({x:c.x,y:s.y},s,t.rotate),l=Math.sqrt(Math.pow(h.x-r.x,2)+Math.pow(h.y-r.y,2)),u={x:h.x-(h.x-r.x)/2,y:h.y+(r.y-h.y)/2},d=t.height;i&&(d=l/n),t.height=d,t.width=Math.round(l),t.top=Math.round(u.y-t.height/2),t.left=Math.round(u.x-l/2),t.fontSize=a}function M(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=o.curPoint,c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])({x:s.x,y:c.y},s,t.rotate),l=Math.sqrt(Math.pow(h.x-r.x,2)+Math.pow(h.y-r.y,2)),u={x:h.x-(h.x-r.x)/2,y:h.y+(r.y-h.y)/2},d=t.width;i&&(d=l*n),t.width=d,t.height=Math.round(l),t.top=Math.round(u.y-l/2),t.left=Math.round(u.x-t.width/2),t.fontSize=a}function $(t,e,n,i,o){var a=null;a=t.height<50||t.width<50?18:t.height<100||t.width<100?30:t.height<150||t.width<150?32:t.height<200||t.width<200?40:t.height<250||t.width<250?60:80;var r=o.symmetricPoint,s=o.curPoint,c=Object(g["a"])(e,s,-t.rotate),h=Object(g["a"])({x:c.x,y:s.y},s,t.rotate),l=Math.sqrt(Math.pow(h.x-r.x,2)+Math.pow(h.y-r.y,2)),u={x:h.x-(h.x-r.x)/2,y:h.y+(r.y-h.y)/2},d=t.height;i&&(d=l/n),t.height=d,t.width=Math.round(l),t.top=Math.round(u.y-t.height/2),t.left=Math.round(u.x-l/2),t.fontSize=a}function L(t,e,n,i,o,a){b[t](e,n,i,o,a)}var k=n("fa7d"),E={props:{active:{type:Boolean,default:!1},element:{required:!0,type:Object,default:function(){}},defaultStyle:{required:!0,type:Object,default:function(){}},index:{required:!0,type:[Number,String],default:0}},data:function(){return{pointList:["lt","t","rt","r","rb","b","lb","l"],pointList2:["r","l"],initialAngle:{lt:0,t:45,rt:90,r:135,rb:180,b:225,lb:270,l:315},angleToCursor:[{start:338,end:23,cursor:"nw"},{start:23,end:68,cursor:"n"},{start:68,end:113,cursor:"ne"},{start:113,end:158,cursor:"e"},{start:158,end:203,cursor:"se"},{start:203,end:248,cursor:"s"},{start:248,end:293,cursor:"sw"},{start:293,end:338,cursor:"w"}],cursors:{}}},computed:Object(h["d"])(["curComponent","editor"]),mounted:function(){var t=this;this.curComponent&&(this.cursors=this.getCursor()),p["a"].$on("runAnimation",(function(){t.element==t.curComponent&&f(t.$el,t.curComponent.animations)})),p["a"].$on("stopAnimation",(function(){t.$el.classList.remove("animated","infinite")}))},methods:{getPointList:function(){return"line-shape"===this.element.component?this.pointList2:this.pointList},isActive:function(){return this.active&&!this.element.isLock},handleRotate:function(t){var e=this;this.$store.commit("setClickComponentStatus",!0),t.preventDefault(),t.stopPropagation();var n=Object(m["a"])({},this.defaultStyle),i=t.clientY,o=t.clientX,a=n.rotate,r=this.$el.getBoundingClientRect(),s=r.left+r.width/2,c=r.top+r.height/2,h=Math.atan2(i-c,o-s)/(Math.PI/180),l=!1,u=function(t){l=!0;var i=t.clientX,o=t.clientY,r=Math.atan2(o-c,i-s)/(Math.PI/180);n.rotate=a+r-h,e.$store.commit("setShapeStyle",n)},d=function t(){l&&e.$store.commit("recordSnapshot"),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",t),e.cursors=e.getCursor()};document.addEventListener("mousemove",u),document.addEventListener("mouseup",d)},getPointStyle:function(t){var e=this.defaultStyle,n=e.width,i=e.height,o=/t/.test(t),a=/b/.test(t),r=/l/.test(t),s=/r/.test(t),c=0,h=0;2===t.length?(c=r?0:n,h=o?0:i):((o||a)&&(c=n/2,h=o?0:i),(r||s)&&(c=r?0:n,h=Math.floor(i/2)));var l={marginLeft:"-4px",marginTop:"-4px",left:"".concat(c,"px"),top:"".concat(h,"px"),cursor:this.cursors[t]};return l},getCursor:function(){var t=this.angleToCursor,e=this.initialAngle,n=this.pointList,i=this.curComponent,o=Object(g["e"])(i.style.rotate),a={},r=-1;return n.forEach((function(n){var i=Object(g["e"])(e[n]+o),s=t.length;while(1){r=(r+1)%s;var c=t[r];if(i<23||i>=338)return void(a[n]="nw-resize");if(c.start<=i&&i<c.end)return void(a[n]=c.cursor+"-resize")}})),a},handleMouseDownOnShape:function(t){var e=this;if(this.$nextTick((function(){return p["a"].$emit("componentClick")})),this.$store.commit("setInEditorStatus",!0),this.$store.commit("setClickComponentStatus",!0),Object(k["e"])(this.element.component)&&t.preventDefault(),t.stopPropagation(),this.$store.commit("setCurComponent",{component:this.element,index:this.index}),!this.element.isLock){this.cursors=this.getCursor();var n=Object(m["a"])({},this.defaultStyle),i=t.clientY,o=t.clientX,a=Number(n.top),r=Number(n.left),s=!1,c=function(t){s=!0;var c=t.clientX,h=t.clientY;n.top=h-i+a,n.left=c-o+r,e.$store.commit("setShapeStyle",n),e.$nextTick((function(){p["a"].$emit("move",h-i>0,c-o>0)}))},h=function t(){s&&e.$store.commit("recordSnapshot"),p["a"].$emit("unmove"),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",t)};document.addEventListener("mousemove",c),document.addEventListener("mouseup",h)}},selectCurComponent:function(t){t.stopPropagation(),t.preventDefault(),this.$store.commit("hideContextMenu")},handleMouseDownOnPoint:function(t,e){var n=this;this.$store.commit("setInEditorStatus",!0),this.$store.commit("setClickComponentStatus",!0),e.stopPropagation(),e.preventDefault();var i=Object(m["a"])({},this.defaultStyle),o=i.width/i.height,a={x:i.left+i.width/2,y:i.top+i.height/2},r=this.editor.getBoundingClientRect(),s=e.target.getBoundingClientRect(),c={x:Math.round(s.left-r.left+e.target.offsetWidth/2),y:Math.round(s.top-r.top+e.target.offsetHeight/2)},h={x:a.x-(c.x-a.x),y:a.y-(c.y-a.y)},l=!1,u=!0,d=this.isNeedLockProportion(),p=function(e){if(u)u=!1;else{l=!0;var s={x:e.clientX-Math.round(r.left),y:e.clientY-Math.round(r.top)};L(t,i,s,o,d,{center:a,curPoint:c,symmetricPoint:h}),n.$store.commit("setShapeStyle",i)}},f=function t(){document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",t),l&&n.$store.commit("recordSnapshot")};document.addEventListener("mousemove",p),document.addEventListener("mouseup",f)},isNeedLockProportion:function(){if("Group"!=this.element.component)return!1;var t,e=[0,90,180,360],n=Object(d["a"])(this.element.propValue);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(!e.includes(Object(g["e"])(parseInt(i.style.rotate))))return!0}}catch(o){n.e(o)}finally{n.f()}return!1}}},N=E,D=(n("9110"),n("2877")),P=Object(D["a"])(N,l,u,!1,null,"2ecd2942",null),_=P.exports,A=n("a7f7"),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.menuShow,expression:"menuShow"}],staticClass:"contextmenu",style:{top:t.menuTop+"px",left:t.menuLeft+"px"}},[n("ul",{on:{mouseup:t.handleMouseUp}},[t.curComponent?[t.curComponent.isLock?n("li",{on:{click:t.unlock}},[t._v("解锁")]):[n("li",{on:{click:t.copy}},[t._v("复制")]),n("li",{on:{click:t.paste}},[t._v("粘贴")]),n("li",{on:{click:t.cut}},[t._v("剪切")]),n("li",{on:{click:t.deleteComponent}},[t._v("删除")]),n("li",{on:{click:t.lock}},[t._v("锁定")]),n("li",{on:{click:t.topComponent}},[t._v("置顶")]),n("li",{on:{click:t.bottomComponent}},[t._v("置底")]),n("li",{on:{click:t.upComponent}},[t._v("上移")]),n("li",{on:{click:t.downComponent}},[t._v("下移")])]]:n("li",{on:{click:t.paste}},[t._v("粘贴")])],2)])},I=[],X={data:function(){return{copyData:null}},computed:Object(h["d"])(["menuTop","menuLeft","menuShow","curComponent"]),methods:{lock:function(){this.$store.commit("lock")},unlock:function(){this.$store.commit("unlock")},handleMouseUp:function(){this.$store.commit("setClickComponentStatus",!0)},cut:function(){this.$store.commit("cut")},copy:function(){this.$store.commit("copy")},paste:function(){this.$store.commit("paste",!0),this.$store.commit("recordSnapshot")},deleteComponent:function(){this.$store.commit("deleteComponent"),this.$store.commit("recordSnapshot")},upComponent:function(){this.$store.commit("upComponent"),this.$store.commit("recordSnapshot")},downComponent:function(){this.$store.commit("downComponent"),this.$store.commit("recordSnapshot")},topComponent:function(){this.$store.commit("topComponent"),this.$store.commit("recordSnapshot")},bottomComponent:function(){this.$store.commit("bottomComponent"),this.$store.commit("recordSnapshot")}}},q=X,R=(n("1b0f"),Object(D["a"])(q,T,I,!1,null,"371e3926",null)),Y=R.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mark-line"},t._l(t.lines,(function(e){return n("div",{directives:[{name:"show",rawName:"v-show",value:t.lineStatus[e]||!1,expression:"lineStatus[line] || false"}],key:e,ref:e,refInFor:!0,staticClass:"line",class:e.includes("x")?"xline":"yline"})})),0)},G=[],U=(n("b64b"),{data:function(){return{lines:["xt","xc","xb","yl","yc","yr"],diff:3,lineStatus:{xt:!1,xc:!1,xb:!1,yl:!1,yc:!1,yr:!1}}},computed:Object(h["d"])(["curComponent","componentData"]),mounted:function(){var t=this;p["a"].$on("move",(function(e,n){t.showLine(e,n)})),p["a"].$on("unmove",(function(){t.hideLine()}))},methods:{hideLine:function(){var t=this;Object.keys(this.lineStatus).forEach((function(e){t.lineStatus[e]=!1}))},showLine:function(t,e){var n=this,i=this.$refs,o=this.componentData,a=Object(A["c"])(this.curComponent.style),r=a.width/2,s=a.height/2;this.hideLine(),o.forEach((function(o){if(o!=n.curComponent){var c=Object(A["c"])(o.style),h=c.top,l=c.left,u=c.bottom,d=c.right,m=c.width/2,p=c.height/2,f={top:[{isNearly:n.isNearly(a.top,h),lineNode:i.xt[0],line:"xt",dragShift:h,lineShift:h},{isNearly:n.isNearly(a.bottom,h),lineNode:i.xt[0],line:"xt",dragShift:h-a.height,lineShift:h},{isNearly:n.isNearly(a.top+s,h+p),lineNode:i.xc[0],line:"xc",dragShift:h+p-s,lineShift:h+p},{isNearly:n.isNearly(a.top,u),lineNode:i.xb[0],line:"xb",dragShift:u,lineShift:u},{isNearly:n.isNearly(a.bottom,u),lineNode:i.xb[0],line:"xb",dragShift:u-a.height,lineShift:u}],left:[{isNearly:n.isNearly(a.left,l),lineNode:i.yl[0],line:"yl",dragShift:l,lineShift:l},{isNearly:n.isNearly(a.right,l),lineNode:i.yl[0],line:"yl",dragShift:l-a.width,lineShift:l},{isNearly:n.isNearly(a.left+r,l+m),lineNode:i.yc[0],line:"yc",dragShift:l+m-r,lineShift:l+m},{isNearly:n.isNearly(a.left,d),lineNode:i.yr[0],line:"yr",dragShift:d,lineShift:d},{isNearly:n.isNearly(a.right,d),lineNode:i.yr[0],line:"yr",dragShift:d-a.width,lineShift:d}]},y=[],v=n.curComponent.style.rotate;Object.keys(f).forEach((function(t){f[t].forEach((function(e){e.isNearly&&(n.$store.commit("setShapeSingleStyle",{key:t,value:0!=v?n.translatecurComponentShift(t,e,a):e.dragShift}),e.lineNode.style[t]="".concat(e.lineShift,"px"),y.push(e.line))}))})),y.length&&n.chooseTheTureLine(y,t,e)}}))},translatecurComponentShift:function(t,e,n){var i=this.curComponent.style,o=i.width,a=i.height;return"top"==t?Math.round(e.dragShift-(a-n.height)/2):Math.round(e.dragShift-(o-n.width)/2)},chooseTheTureLine:function(t,e,n){n?t.includes("yr")?this.lineStatus.yr=!0:t.includes("yc")?this.lineStatus.yc=!0:t.includes("yl")&&(this.lineStatus.yl=!0):t.includes("yl")?this.lineStatus.yl=!0:t.includes("yc")?this.lineStatus.yc=!0:t.includes("yr")&&(this.lineStatus.yr=!0),e?t.includes("xb")?this.lineStatus.xb=!0:t.includes("xc")?this.lineStatus.xc=!0:t.includes("xt")&&(this.lineStatus.xt=!0):t.includes("xt")?this.lineStatus.xt=!0:t.includes("xc")?this.lineStatus.xc=!0:t.includes("xb")&&(this.lineStatus.xb=!0)},isNearly:function(t,e){return Math.abs(t-e)<=this.diff}}}),V=U,B=(n("013f"),Object(D["a"])(V,z,G,!1,null,"a6b29e1c",null)),F=B.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"area",style:{left:t.start.x+"px",top:t.start.y+"px",width:t.width+"px",height:t.height+"px"}})},W=[],J={props:{start:{type:Object,default:function(){}},width:{type:Number,default:0},height:{type:Number,default:0}}},Q=J,K=(n("8e34"),Object(D["a"])(Q,H,W,!1,null,"0a38f41e",null)),Z=K.exports,tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{staticClass:"grid",attrs:{width:"100%",height:"100%",xmlns:"http://www.w3.org/2000/svg"}},[n("defs",[n("pattern",{attrs:{id:"smallGrid",width:"7.236328125",height:"7.236328125",patternUnits:"userSpaceOnUse"}},[n("path",{attrs:{d:"M 7.236328125 0 L 0 0 0 7.236328125",fill:"none",stroke:"rgba(207, 207, 207, 0.3)","stroke-width":"1"}})]),n("pattern",{attrs:{id:"grid",width:"36.181640625",height:"36.181640625",patternUnits:"userSpaceOnUse"}},[n("rect",{attrs:{width:"36.181640625",height:"36.181640625",fill:"url(#smallGrid)"}}),n("path",{attrs:{d:"M 36.181640625 0 L 0 0 0 36.181640625",fill:"none",stroke:"rgba(186, 186, 186, 0.5)","stroke-width":"1"}})])]),n("rect",{attrs:{width:"100%",height:"100%",fill:"url(#grid)"}})])},et=[],nt=(n("3887"),{}),it=Object(D["a"])(nt,tt,et,!1,null,"63feb270",null),ot=it.exports,at=n("340d"),rt={components:{Shape:_,ContextMenu:Y,MarkLine:F,Area:Z,Grid:ot},props:{isEdit:{type:Boolean,default:!0}},data:function(){return{loading:!1,isShowLine:!0,editorX:0,editorY:0,start:{x:0,y:0},width:0,height:0,isShowArea:!1,svgFilterAttrs:["width","height","top","left","rotate"]}},computed:Object(h["d"])(["componentData","curComponent","canvasStyleData","editor"]),mounted:function(){var t=this;this.loading=!0,this.$store.commit("getEditor"),p["a"].$on("hideArea",(function(){t.hideArea()})),Object(at["f"])(this.$route.query.id).then((function(e){var n=e.data;"1"!=n.accidentLocationType&&(t.isShowLine=!1),t.loading=!1}))},methods:{getShapeStyle:A["e"],getCanvasStyle:A["b"],changeStyleWithScale:g["b"],handleMouseDown:function(t){var e=this;this.curComponent&&!Object(k["e"])(this.curComponent.component)||t.preventDefault(),this.hideArea();var n=this.editor.getBoundingClientRect();this.editorX=n.x,this.editorY=n.y;var i=t.clientX,o=t.clientY;this.start.x=i-this.editorX,this.start.y=o-this.editorY,this.isShowArea=!0;var a=function(t){e.width=Math.abs(t.clientX-i),e.height=Math.abs(t.clientY-o),t.clientX<i&&(e.start.x=t.clientX-e.editorX),t.clientY<o&&(e.start.y=t.clientY-e.editorY)},r=function t(n){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",t),n.clientX!=i||n.clientY!=o?e.createGroup():e.hideArea()};document.addEventListener("mousemove",a),document.addEventListener("mouseup",r)},hideArea:function(){this.isShowArea=0,this.width=0,this.height=0,this.$store.commit("setAreaData",{style:{left:0,top:0,width:0,height:0},components:[]})},createGroup:function(){var t=this,e=this.getSelectArea();if(e.length<=1)this.hideArea();else{var n=1/0,i=1/0,o=-1/0,a=-1/0;e.forEach((function(e){var r={};"Group"==e.component?e.propValue.forEach((function(e){var s=Object(k["a"])("#component".concat(e.id)).getBoundingClientRect();r.left=s.left-t.editorX,r.top=s.top-t.editorY,r.right=s.right-t.editorX,r.bottom=s.bottom-t.editorY,r.left<i&&(i=r.left),r.top<n&&(n=r.top),r.right>o&&(o=r.right),r.bottom>a&&(a=r.bottom)})):r=Object(A["c"])(e.style),r.left<i&&(i=r.left),r.top<n&&(n=r.top),r.right>o&&(o=r.right),r.bottom>a&&(a=r.bottom)})),this.start.x=i,this.start.y=n,this.width=o-i,this.height=a-n,this.$store.commit("setAreaData",{style:{left:i,top:n,width:this.width,height:this.height},components:e})}},getSelectArea:function(){var t=this,e=[],n=this.start,i=n.x,o=n.y;return this.componentData.forEach((function(n){if(!n.isLock){var a=Object(A["c"])(n.style),r=a.left,s=a.top,c=a.width,h=a.height;i<=r&&o<=s&&r+c<=i+t.width&&s+h<=o+t.height&&e.push(n)}})),e},handleContextMenu:function(t){t.stopPropagation(),t.preventDefault();var e=t.target,n=t.offsetY,i=t.offsetX;while(e instanceof SVGElement)e=e.parentNode;while(!e.className.includes("editor"))i+=e.offsetLeft,n+=e.offsetTop,e=e.parentNode;this.$store.commit("showContextMenu",{top:n,left:i})},getComponentStyle:function(t){return Object(A["f"])(t,this.svgFilterAttrs)},getSVGStyle:function(t){return Object(A["d"])(t,this.svgFilterAttrs)},handleInput:function(t,e){this.$store.commit("setShapeStyle",{height:this.getTextareaHeight(t,e)})},getTextareaHeight:function(t,e){var n=t.style,i=n.lineHeight,o=n.fontSize,a=n.height;""===i&&(i=1.5);var r=(e.split("<br>").length-1)*i*(o||this.canvasStyleData.fontSize);return a>r?a:r}}},st=rt,ct=(n("3d02"),Object(D["a"])(st,s,c,!1,null,"5ce4b9ec",null)),ht=ct.exports,lt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"component-list",on:{dragstart:t.handleDragStart}},t._l(t.componentList,(function(e,i){return n("div",{key:i,staticClass:"list",attrs:{draggable:"","data-index":i}},["el"===e.icon.substr(0,2)?n("span",{class:e.icon}):n("span",{staticClass:"iconfont",class:"icon-"+e.icon}),n("span",{staticStyle:{"font-size":"12px"}},[t._v(t._s(e.label))])])})),0)},ut=[],dt=n("4e67"),mt={data:function(){return{componentList:dt["c"]}},methods:{handleDragStart:function(t){t.dataTransfer.setData("index",t.target.dataset.index)}}},pt=mt,ft=(n("ed52"),Object(D["a"])(pt,lt,ut,!1,null,"42e5b800",null)),yt=ft.exports,vt=n("ac24"),gt=n("2c7d"),bt=n("4360"),xt=n("7909");var wt=["width","height","fontSize"];function St(t){Object.keys(t.style).forEach((function(e){if(wt.includes(e)){if("fontSize"===e&&""===t.style[e])return;t.style[e]=Ct(t.style[e],bt["a"].state.canvasStyleData.scale)}}))}function Ct(t,e){return Object(xt["b"])(t,Object(xt["a"])(parseFloat(e),100))}var Ot=n("c0e9"),jt=n.n(Ot),Mt=n("2934"),$t={components:{EditorX:ht,ComponentList:yt},data:function(){return{activeName:"attr",reSelectAnimateIndex:void 0}},computed:Object(h["d"])(["componentData","curComponent","isClickComponent","canvasStyleData","editor"]),created:function(){this.restore(),Object(gt["b"])(),this.$store.commit("setComponentData",[])},methods:{handleSaveCanvas:function(){var t=this.$loading({lock:!0,text:"绘制中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),e=this;jt()(document.getElementById("content")).then(function(){var n=Object(r["a"])(Object(a["a"])().mark((function n(i){var o,r,s,c;return Object(a["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=i.toDataURL("image/png").split(",")[1],r=Object(k["b"])(o,"现场勘测平面图","image/png"),s=new FormData,s.append("file",r),n.next=6,Object(Mt["C"])(s);case 6:c=n.sent,t.close(),localStorage.setItem("pmtUrl",JSON.stringify({url:c.data.fileUrl,id:c.data.id,lpId:e.$route.query.id})),e.$router.replace({path:"/compensationManagement/compensationFileUpload",query:{id:e.$route.query.id}});case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}())},restore:function(){},handleDrop:function(t){t.preventDefault(),t.stopPropagation();var e=t.dataTransfer.getData("index"),n=this.editor.getBoundingClientRect();if(e){var i=Object(k["d"])(dt["c"][e]);"zhixian"==(null===i||void 0===i?void 0:i.component)&&(i.style.width=1150,i.style.height=95),i.style.top=t.clientY-n.y,i.style.left=t.clientX-n.x,i.id=Object(vt["a"])(),St(i),this.$store.commit("addComponent",{component:i}),this.$store.commit("recordSnapshot")}},handleDragOver:function(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"},handleMouseDown:function(t){t.stopPropagation(),this.$store.commit("setClickComponentStatus",!1),this.$store.commit("setInEditorStatus",!0)},deselectCurComponent:function(t){this.isClickComponent||this.$store.commit("setCurComponent",{component:null,index:null}),2!=t.button&&this.$store.commit("hideContextMenu")}}},Lt=$t,kt=(n("29f9"),Object(D["a"])(Lt,i,o,!1,null,null,null));e["default"]=kt.exports},"8e34":function(t,e,n){"use strict";n("ac00")},9110:function(t,e,n){"use strict";n("9f60")},"9f60":function(t,e,n){},ac00:function(t,e,n){},ae36:function(t,e,n){},ed52:function(t,e,n){"use strict";n("4159")}}]);