(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a6308c0","chunk-7a6308c0"],{"3e1c":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"pjfyj_comp"},[r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px"}},[r("section",{staticClass:"section_card"},[r("div",{staticClass:"title"},[r("span",[e._v("事故信息")])]),r("el-form",{ref:"form",attrs:{model:e.ruleForm,"label-width":"80px",rules:e.rules}},[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"时间",prop:"time"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"时间",disabled:""},model:{value:e.ruleForm.time,callback:function(t){e.$set(e.ruleForm,"time",t)},expression:"ruleForm.time"}})],1)],1),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"桩号",prop:"accidentLocation"}},[r("el-input",{staticStyle:{width:"500px"},attrs:{placeholder:"桩号",disabled:""},model:{value:e.ruleForm.accidentLocation,callback:function(t){e.$set(e.ruleForm,"accidentLocation",t)},expression:"ruleForm.accidentLocation"}})],1)],1)],1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-form-item",{attrs:{label:"车牌号码",prop:"carPlates"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"车牌号"},model:{value:e.ruleForm.carPlates,callback:function(t){e.$set(e.ruleForm,"carPlates",t)},expression:"ruleForm.carPlates"}})],1)],1),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"承办人",prop:"reporter"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"承办人"},model:{value:e.ruleForm.reporter,callback:function(t){e.$set(e.ruleForm,"reporter",t)},expression:"ruleForm.reporter"}})],1)],1)],1)],1),r("div",{staticClass:"title"},[r("span",[e._v("照片资料")])]),r("div",{staticClass:"img_container"},[r("div",{staticClass:"img_title"},[e._v("1、事故现场车辆左/右前45°全景照片")]),r("upload",{staticStyle:{float:"none"},attrs:{filesList:e.ruleForm.images1,different:"images1",isChange:!0,objParams:{newStyle:!0}},on:{returnRes:e.uploadImg,returnResDel:e.removeImg}}),r("div",{staticClass:"img"},[e._v("请上传到达照片，至少上传一张")]),r("div",{staticClass:"img_title"},[e._v("2、事故现场车辆左/右后45°全景照片")]),r("upload",{staticStyle:{float:"none"},attrs:{filesList:e.ruleForm.images2,different:"images2",isChange:!0,objParams:{newStyle:!0}},on:{returnRes:e.uploadImg,returnResDel:e.removeImg}}),r("div",{staticClass:"img"},[e._v("请上传到达照片，至少上传一张")]),r("div",{staticClass:"img_title"},[e._v("3、事故现场公路路产损坏全景照片")]),r("upload",{staticStyle:{float:"none"},attrs:{filesList:e.ruleForm.images3,different:"images3",isChange:!0,objParams:{newStyle:!0}},on:{returnRes:e.uploadImg,returnResDel:e.removeImg}}),r("div",{staticClass:"img"},[e._v("请上传到达照片，至少上传一张")]),r("div",{staticClass:"img_title"},[e._v("4、公路路产损坏特写照片（测量照片）")]),r("upload",{staticStyle:{float:"none"},attrs:{filesList:e.ruleForm.images4,different:"images4",isChange:!0,objParams:{newStyle:!0}},on:{returnRes:e.uploadImg,returnResDel:e.removeImg}}),r("div",{staticClass:"img"},[e._v("请上传到达照片，至少上传一张")])],1)],1),r("section",{staticStyle:{display:"flex","justify-content":"center",padding:"25px 0"}},[r("el-button",{on:{click:function(t){return e.$emit("close")}}},[e._v("关闭")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)])],1)},i=[],o=r("c7eb"),l=r("1da1"),s=r("5530"),n=(r("4de4"),r("a15b"),r("d81d"),r("14d9"),r("b0c0"),r("d3b7"),r("159b"),r("36fa")),c=r("e95a7"),u={components:{upload:n["a"]},props:{close:{type:Function,require:!0},show:{type:Boolean}},watch:{show:{handler:function(e,t){e?!this.loading&&this.getData():this.ruleForm={}},deep:!0}},data:function(){return{fileList:[],ruleForm:{},rules:{time:[{required:!0,message:"请选择时间",trigger:"blur"}],accidentLocation:[{required:!0,message:"请选择桩号",trigger:"blur"}],carPlates:[{required:!0,message:"请输入车牌号",trigger:"blur"}],reporter:[{required:!0,message:"请输入记录人",trigger:"blur"}]},loading:!0,imgUrl:"/prod-api"}},mounted:function(){this.getData()},methods:{submitForm:function(){var e=this;this.$refs["form"].validate((function(t){if(!t)return!1;e.loading=!0;var r=Object(s["a"])({},e.ruleForm);Object(c["b"])({xczp:r},{businessId:e.$route.query.id,docCode:"new_xczp"}).then((function(t){200==t.code&&(e.loading=!1,e.$message.success("保存成功"),e.$emit("close"))}))}))},uploadImg:function(e){var t={path:e.fileUrl,id:e.id,url:this.imgUrl+e.fileUrl};this.ruleForm[e.different].push(t)},removeImg:function(e){e.id=e.id,this.ruleForm[e.different]=this.ruleForm[e.different].filter((function(t){return t.id!=e.id}))},getData:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c["a"])({businessId:e.$route.query.id,docCode:"new_xczp"}).then((function(t){var r;e.ruleForm=t.data.xczp,e.ruleForm.images1||(e.ruleForm.images1=[]),e.ruleForm.images2||(e.ruleForm.images2=[]),e.ruleForm.images3||(e.ruleForm.images3=[]),e.ruleForm.images4||(e.ruleForm.images4=[]),e.ruleForm.images1.forEach((function(t){t.url=e.imgUrl+t.path})),e.ruleForm.images2.forEach((function(t){t.url=e.imgUrl+t.path})),e.ruleForm.images3.forEach((function(t){t.url=e.imgUrl+t.path})),e.ruleForm.images4.forEach((function(t){t.url=e.imgUrl+t.path})),e.ruleForm.time=t.data.baseData.accidentTime,e.ruleForm.accidentLocation=t.data.baseData.accidentLocation,e.ruleForm.reporter=e.ruleForm.reporter||(null===(r=t.data.baseData)||void 0===r||null===(r=r.clrList)||void 0===r?void 0:r.map((function(e){return e.name})).join(",")),e.loading=!1}));case 3:case"end":return t.stop()}}),t)})))()}}},m=u,d=(r("c22d"),r("2877")),p=Object(d["a"])(m,a,i,!1,null,"86108b46",null);t["default"]=p.exports},c22d:function(e,t,r){"use strict";r("f714")},e95a7:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o}));r("99af");var a=r("b775");function i(e){var t=e.businessId,r=e.docCode;return Object(a["a"])({url:"/roadProducts/roadDoc/docDetails/".concat(t,"/").concat(r),method:"get"})}function o(e,t){var r=t.businessId,i=t.docCode;return Object(a["a"])({url:"/roadProducts/roadDoc/saveDoc/".concat(r,"/").concat(i),method:"post",data:e})}},f714:function(e,t,r){}}]);