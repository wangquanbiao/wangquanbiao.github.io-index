(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2742f2b0"],{1753:function(e,r,t){},"247e":function(e,r,t){},"2a4e":function(e,r,t){},"4b48":function(e,r,t){},"4eb9":function(e,r,t){"use strict";t("247e")},b7a2:function(e,r,t){"use strict";t("4b48")},ce24:function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"app-container"},[t("el-dialog",{attrs:{title:"",visible:e.isShow,isShow:e.show,"append-to-body":"","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(r){e.isShow=r},close:function(r){e.$emit("update:show",!1)}}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px",disabled:!e.isBtn}},[t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"路线名称：",prop:"roadId"}},[e.isBtn?t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.setInitPage},model:{value:e.ruleForm.roadId,callback:function(r){e.$set(e.ruleForm,"roadId",r)},expression:"ruleForm.roadId"}},e._l(e.roadList,(function(e,r){return t("el-option",{key:r,attrs:{label:e.roadDesc,value:e.id}})})),1):t("span",[e._v(e._s(e.ruleForm.roadDesc))])],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"方向：",prop:"directionId"}},[e.isBtn?t("el-row",[t("el-col",{attrs:{span:11}},[t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.startDirection,callback:function(r){e.$set(e.ruleForm,"startDirection",r)},expression:"ruleForm.startDirection"}})],1),t("el-col",{attrs:{span:2}},[e._v(" 至 ")]),t("el-col",{attrs:{span:11}},[t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.endDirection,callback:function(r){e.$set(e.ruleForm,"endDirection",r)},expression:"ruleForm.endDirection"}})],1)],1):t("span",[e._v(e._s(e.ruleForm.startDirection)+" 至 "+e._s(e.ruleForm.endDirection))])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"路线编码："}},[e.isBtn?t("el-input",{attrs:{disabled:""},model:{value:e.ruleForm.roadCode,callback:function(r){e.$set(e.ruleForm,"roadCode",r)},expression:"ruleForm.roadCode"}}):t("span",[e._v(e._s(e.ruleForm.roadCode))])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"建档时间：",prop:"filingTime"}},[e.isBtn?t("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择日期","value-format":"yyyy-MM-dd hh:mm"},model:{value:e.ruleForm.filingTime,callback:function(r){e.$set(e.ruleForm,"filingTime",r)},expression:"ruleForm.filingTime"}}):t("span",[e._v(e._s(e.ruleForm.filingTime))])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"公司名称：",prop:"companyId"}},[e.isBtn?t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:e.setZDID},model:{value:e.ruleForm.companyId,callback:function(r){e.$set(e.ruleForm,"companyId",r)},expression:"ruleForm.companyId"}},e._l(e.depList,(function(e){return t("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}})})),1):t("span",[e._v(e._s(e.ruleForm.companyDesc))])],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:"建档部门："}},[e.isBtn?t("el-cascader",{key:e.cascaderKey,ref:"ancillaryFacilitiesCascader",attrs:{"popper-class":"cascader",options:e.DWList,props:{value:"id",checkStrictly:!0,emitPath:!1},"expand-trigger":"hover"},on:{change:e.handleChange},model:{value:e.ruleForm.orgId,callback:function(r){e.$set(e.ruleForm,"orgId",r)},expression:"ruleForm.orgId"}}):t("span",[e._v(e._s(e.ruleForm.orgDesc))])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[e.ruleForm.roadId?t("el-form-item",{attrs:{label:"记录人："}},[e.isBtn?t("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.recorderId,callback:function(r){e.$set(e.ruleForm,"recorderId",r)},expression:"ruleForm.recorderId"}},e._l(e.qfldList,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.nickName,value:e.userId}})})),1):t("span",[e._v(e._s(e.ruleForm.recorderName))])],1):e._e()],1),t("el-col",{attrs:{span:12}},[e.ruleForm.roadId?t("el-form-item",{attrs:{label:"拍照人："}},[e.isBtn?t("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.ruleForm.photographerId,callback:function(r){e.$set(e.ruleForm,"photographerId",r)},expression:"ruleForm.photographerId"}},e._l(e.qfldList,(function(e){return t("el-option",{key:e.userId,attrs:{label:e.nickName,value:e.userId}})})),1):t("span",[e._v(e._s(e.ruleForm.photographerName))])],1):e._e()],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"所属单位:",prop:"affiliatedUnit"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.affiliatedUnit,callback:function(r){e.$set(e.ruleForm,"affiliatedUnit",r)},expression:"ruleForm.affiliatedUnit"}})],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"桩号：",prop:"midLineKmLevel"}},[t("el-row",[t("el-col",{attrs:{span:12}},[e.isBtn?t("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.midLineKmLevel,callback:function(r){e.$set(e.ruleForm,"midLineKmLevel",r)},expression:"ruleForm.midLineKmLevel"}},[t("template",{slot:"prepend"},[e._v("k")])],2):t("span",[e._v("k"+e._s(e.ruleForm.midLineKmLevel)+"+"+e._s(e.ruleForm.midLineMLevel))])],1),t("el-col",{attrs:{span:12}},[e.isBtn?t("el-input",{attrs:{placeholder:"请输入",oninput:"value=value.replace(/[^0-9]/g,'')"},model:{value:e.ruleForm.midLineMLevel,callback:function(r){e.$set(e.ruleForm,"midLineMLevel",r)},expression:"ruleForm.midLineMLevel"}},[t("template",{slot:"prepend"},[e._v("+")])],2):e._e()],1)],1)],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"联系人：",prop:"contactPerson"}},[t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.contactPerson,callback:function(r){e.$set(e.ruleForm,"contactPerson",r)},expression:"ruleForm.contactPerson"}})],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"联系电话：",prop:"contactPhone"}},[t("el-input",{attrs:{placeholder:"请输入",maxlength:11,clearable:""},model:{value:e.ruleForm.contactPhone,callback:function(r){e.$set(e.ruleForm,"contactPhone",r)},expression:"ruleForm.contactPhone"}})],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"设施名称：",prop:"facilityName"}},[e.isBtn?t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.facilityName,callback:function(r){e.$set(e.ruleForm,"facilityName",r)},expression:"ruleForm.facilityName"}}):t("span",[e._v(e._s(e.ruleForm.facilityName))])],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"护网距离：",prop:"hwDistance"}},[e.isBtn?t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.hwDistance,callback:function(r){e.$set(e.ruleForm,"hwDistance",r)},expression:"ruleForm.hwDistance"}}):t("span",[e._v(e._s(e.ruleForm.hwDistance))])],1)],1)],1),t("el-row",[t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"所有者：",prop:"owner"}},[e.isBtn?t("el-input",{attrs:{placeholder:"请输入"},model:{value:e.ruleForm.owner,callback:function(r){e.$set(e.ruleForm,"owner",r)},expression:"ruleForm.owner"}}):t("span",[e._v(e._s(e.ruleForm.owner))])],1)],1),t("el-col",{attrs:{span:9}},[t("el-form-item",{attrs:{label:"路产类型： ",prop:"roadPropertyType"}},[e.isBtn?t("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{click:e.roadPropertyTypeChange},model:{value:e.ruleForm.roadPropertyType,callback:function(r){e.$set(e.ruleForm,"roadPropertyType",r)},expression:"ruleForm.roadPropertyType"}},e._l(e.roadPropertyTypeList,(function(e){return t("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1):t("span",[e._v(" "+e._s(e.roadPropertyType)+" ")])],1)],1)],1),t("el-row",[t("el-row",[t("el-form-item",{attrs:{label:"照片：",prop:"farPic"}},[e.isBtn?t("upload",{attrs:{filesList:e.filesList,objParams:{id:e.ruleForm.id}},on:{returnRes:e._returnRes,returnResDel:e._returnResDel},model:{value:e.ruleForm.farPic,callback:function(r){e.$set(e.ruleForm,"farPic",r)},expression:"ruleForm.farPic"}}):e._l(e.filesList,(function(e,r){return t("img",{key:r,staticClass:"r_img",attrs:{src:e.url,alt:""}})}))],2)],1),t("el-row",[t("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[e.isBtn?t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.remark,callback:function(r){e.$set(e.ruleForm,"remark",r)},expression:"ruleForm.remark"}}):t("span",[e._v(e._s(e.ruleForm.remark))])],1)],1)],1),e.isBtn?t("el-form-item",{staticStyle:{"margin-top":"40px"}},[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即创建")]),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("重置")])],1):e._e()],1)],1)],1)},i=[],o=t("5530"),l=t("c7eb"),s=t("1da1"),n=(t("4de4"),t("d81d"),t("14d9"),t("a434"),t("a9e3"),t("d3b7"),t("fa7d")),c=t("2934"),d=t("a700"),u=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"uploadStyle"},[t("el-upload",{staticClass:"companyLogo-img",class:{uploadHide:e.isuploadHide},attrs:{multiple:"",action:e.actionUrl,headers:e.headersToken,name:"files",enctype:"multipart/form-data","list-type":e.listType,disabled:e.isEdit,"file-list":e.fileList,limit:e.atmLimit,data:e.atmData,accept:e.atmAccepts,"before-upload":e.beforeUpload,"on-preview":e.imagePreview,"on-remove":e.removeImage,"on-success":e.isSuccess,"on-exceed":e.handleExceed}},["picture-card"===e.listType?t("i",{staticClass:"el-icon-plus"}):e._e(),e.atmParams.describe?t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.atmParams.describe))]):e._e()]),t("el-dialog",{attrs:{visible:e.imgDialogVisible,size:"full",modal:!1,title:"查看大图片"},on:{"update:visible":function(r){e.imgDialogVisible=r}}},[t("img",{attrs:{width:"100%",src:e.assemblePreviewImageUrl,alt:""}})])],1)},m=[],p=t("5f87"),f={name:"upload",data:function(){return{isEdit:!1,isuploadHide:!1,imgDialogVisible:!1,actionUrl:"/prod-api/roadProducts/standardization/upload/",headersToken:{Authorization:"Bearer "+Object(p["a"])()},assemblePreviewImageUrl:"",atmData:{rId:"",modelName:"lyss"},atmParams:this.objParams,atmLimit:999,atmAccepts:"",describe:"",fileList:[],listType:"picture-card",imgList:[]}},props:{objParams:{type:Object,default:function(){return{describe:null,id:null}}},filesList:{type:Array}},watch:{objParams:function(e,r){this.atmParams=e,this.atmLimit=e.atmLimit,this.atmData.rId=null===e||void 0===e?void 0:e.id},filesList:function(e,r){this.fileList=e}},mounted:function(){this.renderFileList()},methods:{handleExceed:function(e,r){this.$message.warning("当前限制选择 ".concat(this.atmLimit," 个文件，,请删除后操作!"))},beforeUpload:function(e){},removeImage:function(e,r){this.$emit("returnResDel",e.response.data[0])},isSuccess:function(e){this.$emit("returnRes",e.data[0])},imagePreview:function(e,r){e.url?this.assemblePreviewImageUrl=e.url:this.assemblePreviewImageUrl="",this.imgDialogVisible=!0},renderFileList:function(){}}},h=f,b=(t("d8ba"),t("efae"),t("2877")),g=Object(b["a"])(h,u,m,!1,null,"39dd4ca0",null),v=g.exports,F={components:{upload:v},props:{show:{type:Boolean,default:!1}},watch:{show:function(){this.isShow=this.show}},data:function(){return{isShowInformation:!0,cascaderKey:0,isOther:!1,roadPropertyType:"",isBtn:!0,isShowLoading:!1,isShow:this.show,reqUrl:"add",stateList:[],depList:[],DWList:[],roadList:[],upAndDownList:[],activeNames:["1","2","3"],ruleForm:{id:Object(n["h"])(),orgId:"",orgDesc:"",companyId:"",companyDesc:"",roadId:"",roadCode:"",roadDesc:"",filingTime:"",rampDir:"",rampName:"",remark:"",directionId:"",recorderId:"",recorderName:"",photographerId:"",photographerName:"",reviewerId:"",reviewerName:"",facilityName:"",midLineKmLevel:"",midLineMLevel:"",hwDistance:"",owner:"",affiliatedUnit:"",contactPerson:"",contactPhone:"",roadPropertyType:""},filesList:[],imgsList:[],qfldList:[],rules:{contactPhone:[{required:!1,message:"请输入",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}],roadId:[{required:!0,message:"请选择",trigger:"change"}],companyId:[{required:!0,message:"请选择",trigger:"change"}],orgId:[{required:!0,message:"请选择",trigger:"change"}],roadCode:[{required:!0,message:"请选择",trigger:"change"}],roadDesc:[{required:!0,message:"请选择",trigger:"change"}],midLineKmLevel:[{required:!0,message:"请输入",trigger:"blur"}],midLineMLevel:[{required:!0,message:"请输入",trigger:"blur"}],facilityName:[{required:!0,message:"请输入",trigger:"blur"}]},roadPropertyTypeList:[]}},created:function(){this.INITDATA(),this.getData()},methods:{handleChange:function(e){var r;this.$refs.ancillaryFacilitiesCascader&&(this.ruleForm.orgDesc=null===(r=this.$refs.ancillaryFacilitiesCascader.getCheckedNodes()[0])||void 0===r?void 0:r.data.label,this.$refs.ancillaryFacilitiesCascader.dropDownVisible=!1)},roadPropertyTypeChange:function(){726!=this.ruleForm.roadPropertyType?this.isOther=!1:this.isOther=!0},getqfldData:function(e){var r=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["q"])({pageNum:1,pageSize:100,deptId:e});case 2:a=t.sent,r.qfldList=a.rows;case 4:case"end":return t.stop()}}),t)})))()},_returnRes:function(e){var r={name:e.fileName,attachId:e.id,fileUrl:e.fileUrl};this.imgsList.push(r)},_returnResDel:function(e){for(var r={name:e.fileName,attachId:e.id,fileUrl:e.fileUrl},t=this.imgsList,a=0;a<t.length;a++)if(t[a].attachId==r.attachId){this.imgsList.splice(a,1);break}Object(d["r"])(e.id).then((function(e){}))},setInitPage:function(e){for(var r=0;r<this.roadList.length;r++)if(this.roadList[r].id==e){this.ruleForm.startDirection=this.roadList[r].startDirection,this.ruleForm.endDirection=this.roadList[r].endDirection,this.ruleForm.roadCode=this.roadList[r].roadCode,this.ruleForm.roadCode=this.roadList[r].roadCode,this.getqfldData(this.ruleForm.companyId);break}},getData:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function r(){var t,a,i,s,n,u;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t=e.$store.getters.userInfo,a={relationId:"105",companyId:"",orgId:"",roadDesc:""},i=Object(o["a"])(Object(o["a"])({},a),{},{pageNum:1,pageSize:99}),r.next=5,Object(d["J"])(i);case 5:return s=r.sent,e.roadList=s.rows,r.next=9,Object(c["j"])();case 9:return n=r.sent,e.depList=n.data,r.next=13,Object(c["g"])({ancestors:e.ruleForm.companyId,isFilter:!0});case 13:if(u=r.sent,e.DWList=u.data,t.roles.map((function(r){("jtld"==r.roleKey||r.admin)&&(e.isShowInformation=!1)})),e.isShowInformation){r.next=18;break}return r.abrupt("return");case 18:e.ruleForm.companyDesc=t.companyName,e.ruleForm.companyId=t.companyId,e.ruleForm.orgId=t.dept.deptId,e.ruleForm.orgDesc=t.dept.deptName;case 22:case"end":return r.stop()}}),r)})))()},submitForm:function(e){var r=this,t="add"==this.reqUrl?"post":"put";"add"==t&&(this.ruleForm.id=""),this.$refs[e].validate((function(e){if(!e)return!1;for(var a=0;a<r.roadList.length;a++)if(r.ruleForm.roadCode==r.roadList[a].roadCode){r.ruleForm.roadDesc=r.roadList[a].roadDesc;break}for(var i=0;i<r.qfldList.length;i++)r.ruleForm.recorderId==r.qfldList[i].userId&&(r.ruleForm.recorderName=r.qfldList[i].nickName),r.ruleForm.photographerId==r.qfldList[i].userId&&(r.ruleForm.photographerName=r.qfldList[i].nickName),r.ruleForm.reviewerId==r.qfldList[i].userId&&(r.ruleForm.reviewerName=r.qfldList[i].nickName);r.isShowLoading||(r.isShowLoading=!0,Object(d["n"])(r.ruleForm,r.reqUrl,t).then((function(e){200==e.code&&(r.$message({message:"成功!",type:"success"}),r.$emit("notice"),r.isShowLoading=!1,r.resetForm("ruleForm"),r.isShow=!1)})).catch((function(e){r.isShowLoading=!1})))}))},resetForm:function(e){this.ruleForm.orgId=void 0,this.ruleForm.companyId=void 0,this.ruleForm.startLineMLevel=void 0,this.ruleForm.endLineMLevel=void 0,this.ruleForm.installationTypeId=void 0,this.ruleForm.id=void 0,this.filesList=[],this.imgsList=[],this.$refs[e].resetFields()},setIsShowBtn:function(e){this.isBtn=e},setUrl:function(e){this.reqUrl=e},getInfo:function(e){var r=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a,i,o,s,n,u,m,p,f;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r.isShow=!0,t.next=3,Object(d["p"])(e);case 3:return i=t.sent,r.getqfldData(i.data.companyId),i.data.recorderId=Number(i.data.recorderId),i.data.reviewerId=Number(i.data.reviewerId),i.data.photographerId=i.data.photographerId?Number(i.data.photographerId):"",i.data.roadPropertyType=i.data.roadPropertyType?String(i.data.roadPropertyType):"",r.roadPropertyType=null===(a=r.roadPropertyTypeList.filter((function(e){return e.dictValue==i.data.roadPropertyType}))[0])||void 0===a?void 0:a.dictLabel,t.next=12,Object(c["j"])();case 12:for(o=t.sent,r.depList=o.data,r.ruleForm=i.data,s=i.data.fileList||[],n=[],u=[],m=0;m<s.length;m++)p={name:s[m].fileName,attachId:s[m].id,fileUrl:"/prod-api"+s[m].fileUrl},f={name:s[m].fileName,url:"/prod-api"+s[m].fileUrl,response:{data:[{name:s[m].fileName,url:"/prod-api"+s[m].fileUrl,attachId:s[m].id,id:s[m].id,fileUrl:"/prod-api"+s[m].fileUrl}]}},n.push(p),u.push(f);r.imgsList=n,r.filesList=u;case 19:case"end":return t.stop()}}),t)})))()},setZDID:function(e){var r=this;return Object(s["a"])(Object(l["a"])().mark((function t(){var a;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r.DWList=[],r.ruleForm.orgId=void 0,r.ruleForm.orgDesc=void 0,r.ruleForm.companyDesc=r.depList.filter((function(r){return r.deptId==e}))[0].deptName,r.cascaderKey=0,t.next=7,Object(c["g"])({ancestors:e,isFilter:!0});case 7:a=t.sent,r.DWList=a.data;case 9:case"end":return t.stop()}}),t)})))()},INITDATA:function(){var e=this;return Object(s["a"])(Object(l["a"])().mark((function r(){var t,a,i;return Object(l["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,Object(c["k"])({dictType:"tunnel_direction"});case 2:return t=r.sent,e.upAndDownList=t.rows,r.next=6,Object(c["k"])({dictType:"road_main_line_level"});case 6:return a=r.sent,e.stateList=a.rows,r.next=10,Object(c["k"])({dictType:"road_construct_type"});case 10:i=r.sent,e.roadPropertyTypeList=i.rows;case 12:case"end":return r.stop()}}),r)})))()}}},y=F,L=(t("4eb9"),t("b7a2"),Object(b["a"])(y,a,i,!1,null,"458d25c2",null));r["default"]=L.exports},d8ba:function(e,r,t){"use strict";t("2a4e")},efae:function(e,r,t){"use strict";t("1753")}}]);